/* Searching */select DepDelay FROM airline WHERE DepDelay > 30 LIMIT 20;
select DepDelay FROM airline WHERE DepDelay > 30 and ArrDelayMinutes > 30 LIMIT 20;
select ArrDelayMinutes FROM airline WHERE ArrDelayMinutes > 30 LIMIT 20;
select ArrDelayMinutes FROM airline WHERE ArrDelayMinutes > 60 AND DayOfWeek = 6 LIMIT 20;
select ArrDelayMinutes, YearOfFlight FROM airline where YearOfFlight = 2014 LIMIT 20;
select ArrDelayMinutes, YearOfFlight FROM airline where YearOfFlight = 2015 LIMIT 20;
/* Sorting */select ArrDelayMinutes FROM airline ORDER BY ArrDelayMinutes LIMIT 20;
select ArrDelayMinutes FROM airline ORDER BY ArrDelayMinutes DESC LIMIT 20;
select DepDelay FROM airline ORDER BY DepDelay LIMIT 20;
/* Transformation */select abs(DepDelay / 2.22) FROM airline DESC LIMIT 20;
select DepDelay * 2.22 FROM airline ORDER BY DepDelay DESC LIMIT 20;
select ArrDelayMinutes * 2.22 FROM airline where YearOfFlight = 2015 ORDER BY ArrDelayMinutes DESC LIMIT 20;
select abs(ArrDelayMinutes * 2.22) FROM airline order by ArrDelayMinutes DESC LIMIT 20;
select ArrDelayMinutes / 2.22 FROM airline ORDER BY ArrDelayMinutes ASC LIMIT 20;
/* Aggregation */select sum(ArrDelayMinutes) as "sum" FROM airline;
select sum(ArrDelayMinutes) as "sum" FROM airline WHERE YearOfFlight = 2014;
select sum(ArrDelayMinutes) as "sum" FROM airline WHERE YearOfFlight = 2015;
select avg(ArrDelayMinutes) as "avg" FROM airline;
select avg(ArrDelayMinutes) as "avg" FROM airline WHERE YearOfFlight = 2014;
select avg(ArrDelayMinutes) as "avg" FROM airline WHERE YearOfFlight = 2015;
select max(ArrDelayMinutes) as "max" FROM airline;
select max(ArrDelayMinutes) as "max" FROM airline WHERE YearOfFlight = 2014;
select max(ArrDelayMinutes) as "max" FROM airline WHERE YearOfFlight = 2015;
select max(DepDelay) as "max" FROM airline WHERE YearOfFlight = 2014;
select max(DepDelay) as "max" FROM airline WHERE YearOfFlight = 2015;
select avg(ArrDelayMinutes) as "avg", max(ArrDelayMinutes) as "max", min(ArrDelayMinutes) as "min" FROM airline;
/* Custom */SELECT OriginCityName, DestCityName, count(*) AS flights FROM airline GROUP BY OriginCityName, DestCityName ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, DestCityName, count(*) AS flights FROM airline WHERE YearOfFlight = 2014 GROUP BY OriginCityName, DestCityName ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, DestCityName, count(*) AS flights FROM airline WHERE YearOfFlight = 2015 GROUP BY OriginCityName, DestCityName ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, count(*) AS flights FROM airline GROUP BY OriginCityName ORDER BY flights ASC LIMIT 10;
SELECT OriginCityName, count(*) AS flights FROM airline GROUP BY OriginCityName ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, count(*) AS flights, sum(ArrDelayMinutes) as "sumDelay", avg(ArrDelayMinutes) as "avgDelay" FROM airline GROUP BY OriginCityName ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, YearOfFlight, count(*) AS flights, sum(ArrDelayMinutes) as "sumDelay", avg(ArrDelayMinutes) as "avgDelay" FROM airline GROUP BY OriginCityName, YearOfFlight HAVING YearOfFlight = 2014 ORDER BY flights DESC LIMIT 20;
SELECT OriginCityName, count(distinct Dest) AS u FROM airline GROUP BY OriginCityName ORDER BY u DESC LIMIT 20;
SELECT OriginCityName, count(distinct Dest) AS u FROM airline GROUP BY OriginCityName, YearOfFlight HAVING YearOfFlight = 2014 ORDER BY u LIMIT 20;
SELECT DayOfWeek, count() AS c, avg(DepDelay) AS delays FROM airline GROUP BY DayOfWeek ORDER BY DayOfWeek;
SELECT DayOfWeek, count() AS c, max(DepDelay) AS delays FROM airline GROUP BY DayOfWeek ORDER BY DayOfWeek;
SELECT DayOfWeek, avg(DepDelay) AS delays FROM airline GROUP BY DayOfWeek ORDER BY DayOfWeek;
SELECT DayOfWeek, avg(DepDelay) AS delays FROM airline GROUP BY DayOfWeek ORDER BY DayOfWeek;
SELECT OriginCityName, count() AS c, avg(DepDelay) AS delays FROM airline GROUP BY OriginCityName HAVING c > 100000 ORDER BY delays DESC LIMIT 20;
SELECT OriginCityName, count() AS c, avg(DepDelay) AS delays FROM airline GROUP BY OriginCityName HAVING c > 200000 ORDER BY delays DESC LIMIT 20;
SELECT OriginCityName, avg(DepDelay) AS delays FROM airline GROUP BY OriginCityName HAVING delays > 100000 ORDER BY delays DESC LIMIT 20;
SELECT OriginCityName, DestCityName, count(*) AS flights, avg(AirTime) AS duration FROM airline GROUP BY OriginCityName, DestCityName ORDER BY duration DESC limit 20;
SELECT OriginCityName, DestCityName, count(*) AS flights, avg(AirTime) AS duration FROM airline GROUP BY YearOfFlight, OriginCityName, DestCityName HAVING YearOfFlight = 2014 ORDER BY duration DESC limit 20;
SELECT OriginCityName, DestCityName, avg(AirTime) AS duration FROM airline GROUP BY YearOfFlight, OriginCityName, DestCityName ORDER BY duration DESC limit 20;
SELECT Carrier, min(YearOfFlight), max(YearOfFlight), count() FROM airline GROUP BY Carrier ORDER BY count() DESC;
SELECT Carrier, min(YearOfFlight), max(YearOfFlight), count() FROM airline GROUP BY Carrier HAVING max(YearOfFlight) < 2015 ORDER BY count() DESC;
SELECT Carrier, min(YearOfFlight), max(YearOfFlight) FROM airline GROUP BY Carrier ORDER BY avg(AirTime) DESC;
SELECT T.DestCityName AS DC, max(total), avg(abs(monthly * 12 - total) / total) AS avg_month_diff FROM ( SELECT DestCityName, count() AS total FROM airline GROUP BY DestCityName HAVING total > 100000 ) AS T INNER JOIN ( SELECT DestCityName, MonthOfFlight, count() AS monthly FROM airline GROUP BY DestCityName, MonthOfFlight HAVING monthly > 10000 ) USING (DestCityName) GROUP BY DC ORDER BY avg_month_diff DESC LIMIT 20;
SELECT T.DestCityName AS DC, max(total), avg(abs(monthly * 12 - total) / total) AS avg_month_diff FROM ( SELECT DestCityName, count() AS total FROM airline GROUP BY DestCityName HAVING total > 200000 ) AS T INNER JOIN ( SELECT DestCityName, MonthOfFlight, count() AS monthly FROM airline GROUP BY DestCityName, MonthOfFlight HAVING monthly > 20000 ) USING (DestCityName) GROUP BY DC ORDER BY avg_month_diff ASC LIMIT 20;
SELECT DayOfWeek, count(*) AS c FROM airline WHERE YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY DayOfWeek ORDER BY c DESC;
SELECT DayOfWeek, count(*) AS c FROM airline WHERE DepDelay>10 AND YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY DayOfWeek ORDER BY c DESC;
SELECT Origin, count(*) AS c FROM airline WHERE DepDelay>10 AND YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY Origin ORDER BY c DESC LIMIT 10;
SELECT Carrier, count(*) FROM airline WHERE DepDelay>10 AND YearOfFlight=2007 GROUP BY Carrier ORDER BY count(*) DESC;
SELECT c3, c4, c, c2, c*100/c2 as c5 FROM (SELECT Carrier AS c3, count(*) AS c FROM airline WHERE DepDelay>10 AND YearOfFlight=2007 GROUP BY c3) INNER JOIN ( SELECT Carrier AS c4, count(*) AS c2 FROM airline WHERE YearOfFlight=2007 GROUP BY c4 ) ON (c3 = c4) ORDER BY c5 DESC;
SELECT Carrier, avg(DepDelay)*100 AS c3 FROM airline WHERE YearOfFlight=2007 GROUP BY Carrier ORDER BY Carrier;
SELECT c3, c, c2, c*100/c2 as c5 FROM (SELECT Carrier AS c3, count(*) AS c FROM airline WHERE DepDelay>10 AND YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY c3) INNER JOIN (SELECT Carrier AS c4, count(*) AS c2 FROM airline WHERE YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY c4) ON (c3 = c4) ORDER BY c5 DESC;
SELECT Carrier, avg(DepDelay)*100 AS c3 FROM airline WHERE YearOfFlight>=2000 AND YearOfFlight<=2008 GROUP BY Carrier ORDER BY Carrier;
SELECT y1, c1/c2 FROM ( select YearOfFlight as y1, count(*)*100 as c1 from airline WHERE DepDelay>10 GROUP BY y1 ) INNER JOIN ( select YearOfFlight as y2, count(*) as c2 from airline GROUP BY y2 ) on (y1 = y2) ORDER BY y1;
SELECT YearOfFlight, avg(DepDelay) FROM airline GROUP BY YearOfFlight ORDER BY YearOfFlight;
SELECT DestCityName, count(distinct OriginCityName) AS u FROM airline WHERE YearOfFlight>=2000 and YearOfFlight<=2010 GROUP BY DestCityName ORDER BY u DESC LIMIT 10;
SELECT YearOfFlight, count(*) AS c1 FROM airline GROUP BY YearOfFlight;
SELECT min(YearOfFlight), max(YearOfFlight), Carrier, count(*) AS cnt, sum(ArrDelayMinutes) AS flights_delayed, round(sum(ArrDelayMinutes)/count(*),2) AS rate FROM airline WHERE DayOfWeek NOT IN (6,7) AND OriginState NOT IN ('AK', 'HI', 'PR', 'VI') AND DestState NOT IN ('AK', 'HI', 'PR', 'VI') AND FlightDate < '2010-01-01' GROUP by Carrier HAVING count(*) >100000 and max(YearOfFlight)>1990 ORDER by rate DESC LIMIT 1000;
SELECT avg(cnt) FROM ( SELECT YearOfFlight,MonthOfFlight,count(*) AS cnt FROM airline WHERE DepDel15=1 GROUP BY YearOfFlight,MonthOfFlight );
SELECT avg(c1) FROM ( SELECT YearOfFlight,MonthOfFlight,count(*) AS c1 FROM airline GROUP BY YearOfFlight,MonthOfFlight );
SELECT DestCityName, count(distinct OriginCityName) AS u FROM airline GROUP BY DestCityName ORDER BY u DESC LIMIT 10;
SELECT OriginCityName, DestCityName, count() AS c FROM airline GROUP BY OriginCityName, DestCityName ORDER BY c DESC LIMIT 10;
SELECT OriginCityName, count() AS c FROM airline GROUP BY OriginCityName ORDER BY c DESC LIMIT 10;

